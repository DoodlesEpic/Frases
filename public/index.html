<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Frases</title>
    <meta name="description" content="As melhores frases motivacionais ou de inspiração para melhorar seu dia e te mentar motivado">

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="https://getbootstrap.com/docs/4.3/examples/cover/cover.css" rel="stylesheet">

    <style media="screen">
      body { color: rgba(0,0,0,0.87); font-family: Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; display: flex; color: #fff; text-shadow: 0 .05rem .1rem rgba(0, 0, 0, .5); box-shadow: inset 0 0 5rem rgba(0, 0, 0, .5); }
      #load { color: rgba(0,0,0,0.4); text-align: center; font-size: 13px; }
      @media (max-width: 600px) {
        body, #message { margin-top: 0; }
      }

    </style>
  </head>

  <body class="container-fluid">

    <script src="https://www.gstatic.com/firebasejs/5.9.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCwjqBBW4mVV7m4NDqrLyd4PAtSaLwN23I",
        authDomain: "frases-7f8cb.firebaseapp.com",
        databaseURL: "https://frases-7f8cb.firebaseio.com",
        projectId: "frases-7f8cb",
        storageBucket: "frases-7f8cb.appspot.com",
        messagingSenderId: "192789687047"
      };
      firebase.initializeApp(config);
    </script>
    
    <div class="row" style="margin: auto;">
      <div class="col" style="margin: auto;">
        <h1 id="frase">O que importa é a intenção</h1>
        <button onclick="updateText()" class="btn btn-lg btn-dark mt-5 float-right">Outra frase</button>
      </div>
    </div>

    <script>
      var firestore = firebase.firestore();

      frase = 0;

      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function updateText() {
        num_frases = firestore.doc("frases/num");

        num_frases.get().then( function (num_frases_doc) {
          if(num_frases_doc.exists) {
            dados = num_frases_doc.data();
            frase = getRandomInt(1, dados.frases);
            console.log("Quantas frases: " + dados.frases + " Número sorteado: " + frase);
          }
        }).catch(function (error) {
          console.log("Deu ruim: " + error);
        });

        frase_firestore = firestore.doc("frases/" + frase);
        
        frase_firestore.get().then( function (frase_firestore_doc) {
          if(frase_firestore_doc.exists) {
            dados = frase_firestore_doc.data();
            document.getElementById("frase").innerHTML = dados.frase;
          }
        }).catch(function (error) {
          console.log("Deu ruim: " + error);
        });
      }
    </script>
  </body>
</html>
