<!DOCTYPE html>
<html class="h-100">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Frases</title>
    <meta
      name="description"
      content="As melhores frases motivacionais ou de inspiração para melhorar seu dia e te mentar motivado"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <style media="screen">
      .btn-secondary,
      .btn-secondary:hover,
      .btn-secondary:focus {
        color: #ffffff;
        text-shadow: none; /* Prevent inheritance from `body` */
      }

      body {
        text-shadow: 0 0.05rem 0.1rem rgba(0, 0, 0, 0.5);
        box-shadow: inset 0 0 5rem rgba(0, 0, 0, 0.5);
      }
    </style>
  </head>

  <body class="d-flex h-100 text-center text-white bg-dark">
    <script src="https://www.gstatic.com/firebasejs/5.9.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCwjqBBW4mVV7m4NDqrLyd4PAtSaLwN23I",
        authDomain: "frases-7f8cb.firebaseapp.com",
        databaseURL: "https://frases-7f8cb.firebaseio.com",
        projectId: "frases-7f8cb",
        storageBucket: "frases-7f8cb.appspot.com",
        messagingSenderId: "192789687047",
      };
      firebase.initializeApp(config);
    </script>

    <div class="d-flex h-100 mx-auto flex-column">
      <main class="my-auto">
        <h1 id="frase">O que importa é a intenção</h1>
        <button
          onclick="updateText()"
          class="btn btn-secondary btn-lg mt-3 float-end"
        >
          Outra frase
        </button>
      </main>
    </div>

    <script>
      var firestore = firebase.firestore();

      frase = 0;

      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function updateText() {
        num_frases = firestore.doc("frases/num");

        num_frases
          .get()
          .then(function (num_frases_doc) {
            if (num_frases_doc.exists) {
              dados = num_frases_doc.data();
              frase = getRandomInt(1, dados.frases);
              console.log(
                "Quantas frases: " + dados.frases + " Número sorteado: " + frase
              );
            }
          })
          .catch(function (error) {
            console.log("Deu ruim: " + error);
          });

        frase_firestore = firestore.doc("frases/" + frase);

        frase_firestore
          .get()
          .then(function (frase_firestore_doc) {
            if (frase_firestore_doc.exists) {
              dados = frase_firestore_doc.data();
              document.getElementById("frase").innerHTML = dados.frase;
            }
          })
          .catch(function (error) {
            console.log("Deu ruim: " + error);
          });
      }
    </script>
  </body>
</html>
